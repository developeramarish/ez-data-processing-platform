<!DOCTYPE html>
<html>
<head>
    <title>Clear Browser Cache</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 4px;
        }
        .warning {
            background-color: #ff9800;
            color: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .success {
            background-color: #4CAF50;
            color: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
            display: none;
        }
    </style>
</head>
<body>
    <h1>Clear Application Cache</h1>
    
    <div class="warning">
        <h2>⚠️ This will clear ALL cached data for localhost:3000</h2>
        <p>Including:</p>
        <ul>
            <li>localStorage</li>
            <li>sessionStorage</li>
            <li>IndexedDB</li>
            <li>Service Workers</li>
            <li>Cache Storage</li>
        </ul>
    </div>

    <button class="button" onclick="clearAll()">Clear All Cache & Reload</button>

    <div id="success" class="success">
        <h2>✅ Cache Cleared Successfully!</h2>
        <p>Redirecting to http://localhost:3000 in 3 seconds...</p>
    </div>

    <script>
        async function clearAll() {
            try {
                // Clear localStorage
                localStorage.clear();
                console.log('✓ localStorage cleared');

                // Clear sessionStorage
                sessionStorage.clear();
                console.log('✓ sessionStorage cleared');

                // Clear IndexedDB
                if (window.indexedDB) {
                    const dbs = await indexedDB.databases();
                    dbs.forEach(db => {
                        if (db.name) indexedDB.deleteDatabase(db.name);
                    });
                    console.log('✓ IndexedDB cleared');
                }

                // Unregister service workers
                if ('serviceWorker' in navigator) {
                    const registrations = await navigator.serviceWorker.getRegistrations();
                    for (let registration of registrations) {
                        await registration.unregister();
                    }
                    console.log('✓ Service Workers unregistered');
                }

                // Clear caches
                if ('caches' in window) {
                    const cacheNames = await caches.keys();
                    await Promise.all(cacheNames.map(cacheName => caches.delete(cacheName)));
                    console.log('✓ Cache Storage cleared');
                }

                // Show success message
                document.getElementById('success').style.display = 'block';

                // Redirect after 3 seconds
                setTimeout(() => {
                    window.location.href = 'http://localhost:3000';
                }, 3000);

            } catch (error) {
                console.error('Error clearing cache:', error);
                alert('Error clearing cache: ' + error.message);
            }
        }
    </script>
</body>
</html>
