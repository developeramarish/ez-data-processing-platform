# EZ Platform - Helm Chart Values
# Default configuration for production deployment

global:
  namespace: ez-platform
  imageRegistry: docker.io
  imagePullPolicy: Never

# Microservices Configuration
services:
  filediscovery:
    enabled: true
    replicas: 2
    image:
      repository: ez-platform/filediscovery
      tag: v0.1.1-rc1
    strategy:
      maxSurge: 1
      maxUnavailable: 0
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 2000m
        memory: 4Gi
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      initialDelaySeconds: 20
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 2
    extraEnv: []

  fileprocessor:
    enabled: true
    replicas: 5
    image:
      repository: ez-platform/fileprocessor
      tag: v0.1.1-rc1
    strategy:
      maxSurge: 2
      maxUnavailable: 1
    config:
      concurrentFiles: "10"
      maxFileSizeMB: "1000"
    resources:
      requests:
        cpu: 1000m
        memory: 2Gi
      limits:
        cpu: 4000m
        memory: 8Gi
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      initialDelaySeconds: 20
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 2
    extraEnv: []

  validation:
    enabled: true
    replicas: 3
    image:
      repository: ez-platform/validation
      tag: v0.1.1-rc1
    strategy:
      maxSurge: 2
      maxUnavailable: 1
    resources:
      requests:
        cpu: 1000m
        memory: 2Gi
      limits:
        cpu: 3000m
        memory: 6Gi
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      initialDelaySeconds: 20
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 2
    extraEnv: []

  output:
    enabled: true
    replicas: 3
    image:
      repository: ez-platform/output
      tag: v0.1.1-rc1
    strategy:
      maxSurge: 2
      maxUnavailable: 1
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 2000m
        memory: 4Gi
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      initialDelaySeconds: 20
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 2
    extraEnv: []

  datasourceManagement:
    enabled: true
    replicas: 2
    image:
      repository: ez-platform/datasource-management
      tag: v0.1.1-rc1
    strategy:
      maxSurge: 1
      maxUnavailable: 0
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 2000m
        memory: 3Gi
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      initialDelaySeconds: 20
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 2
    extraEnv: []

  metricsConfiguration:
    enabled: true
    replicas: 2
    image:
      repository: ez-platform/metrics-configuration
      tag: v0.1.1-rc1
    strategy:
      maxSurge: 1
      maxUnavailable: 0
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 2000m
        memory: 3Gi
    livenessProbe:
      initialDelaySeconds: 60
      periodSeconds: 30
      timeoutSeconds: 5
      failureThreshold: 5
    readinessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    extraEnv: []

  invalidrecords:
    enabled: true
    replicas: 2
    image:
      repository: ez-platform/invalidrecords
      tag: v0.1.1-rc1
    strategy:
      maxSurge: 1
      maxUnavailable: 0
    resources:
      requests:
        cpu: 500m
        memory: 1Gi
      limits:
        cpu: 2000m
        memory: 3Gi
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      initialDelaySeconds: 20
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 2
    extraEnv: []

  scheduling:
    enabled: true
    replicas: 1
    image:
      repository: ez-platform/scheduling
      tag: v0.1.1-rc1
    strategy:
      maxSurge: 1
      maxUnavailable: 0
    resources:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: 1000m
        memory: 2Gi
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      initialDelaySeconds: 20
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 2
    extraEnv: []

  frontend:
    enabled: true
    replicas: 2
    image:
      repository: frontend
      tag: v0.1.1-rc1
      pullPolicy: IfNotPresent
    strategy:
      maxSurge: 1
      maxUnavailable: 0
    config:
      apiBaseUrl: "http://datasource-management:5001"
    service:
      type: LoadBalancer
      port: 80
    resources:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: 1000m
        memory: 2Gi
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readinessProbe:
      initialDelaySeconds: 10
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 2
    extraEnv: []

# Infrastructure Configuration
mongodb:
  enabled: true
  replicas: 3
  image: mongo:8.0
  replicaSet: rs0
  storage: 20Gi
  storageClass: standard
  resources:
    requests:
      cpu: 1000m
      memory: 2Gi
    limits:
      cpu: 2000m
      memory: 4Gi
  livenessProbe:
    initialDelaySeconds: 60
    periodSeconds: 10
    failureThreshold: 3
  readinessProbe:
    initialDelaySeconds: 30
    periodSeconds: 10
    failureThreshold: 3
  extraEnv: []
  external:
    enabled: false
    connectionString: ""

kafka:
  enabled: true
  replicas: 3
  image: confluentinc/cp-kafka:7.5.0
  storage: 10Gi
  storageClass: standard
  config:
    offsetsReplicationFactor: "1"
    transactionStateLogReplicationFactor: "1"
    transactionStateLogMinIsr: "1"
    logRetentionHours: "168"
  resources:
    requests:
      cpu: 1000m
      memory: 2Gi
    limits:
      cpu: 2000m
      memory: 4Gi
  zookeeper:
    enabled: true
    replicas: 1
    image: confluentinc/cp-zookeeper:7.5.0
    storage: 5Gi
    resources:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: 500m
        memory: 1Gi
    extraEnv: []
  extraEnv: []
  external:
    enabled: false
    bootstrapServers: ""

hazelcast:
  enabled: true
  replicas: 3
  image: hazelcast/hazelcast:5.6
  clusterName: data-processing-cluster
  storage: 5Gi
  storageClass: standard
  jvm:
    minMemory: 256m
    maxMemory: 512m
  resources:
    requests:
      cpu: 1000m
      memory: 8Gi
    limits:
      cpu: 2000m
      memory: 10Gi
  livenessProbe:
    initialDelaySeconds: 60
    periodSeconds: 10
  readinessProbe:
    initialDelaySeconds: 30
    periodSeconds: 5
  maps:
    fileContent:
      ttlSeconds: 300
      maxIdleSeconds: 180
      maxSizeMB: 256
      backupCount: 0
    validRecords:
      ttlSeconds: 300
      maxIdleSeconds: 180
      maxSizeMB: 256
      backupCount: 0
    fileHashes:
      ttlSeconds: 14400
      maxIdleSeconds: 7200
      maxSizeMB: 128
      backupCount: 0
  extraEnv: []
  external:
    enabled: false
    members: ""

# Storage Configuration
storage:
  dataInput:
    enabled: true
    size: 50Gi
    storageClass: standard
  dataOutput:
    enabled: true
    size: 100Gi
    storageClass: standard
  externalData:
    enabled: true
    hostPath: /mnt/external-test-data

# Configuration
config:
  environment: Production
  databaseName: ezplatform
  logLevel: Information
  logLevelMicrosoft: Warning
  logLevelSystem: Warning

  # File Discovery Configuration
  fileDiscovery:
    deduplicationTTLHours: "0.25"  # 15 min for testing, 4-24 hours for production

  # Hazelcast Configuration
  hazelcast:
    cacheTTLHours: "1"

# Observability Configuration
observability:
  otel:
    enabled: true
    external:
      enabled: false
      endpoint: ""
  elasticsearch:
    enabled: true
    external:
      enabled: false
      endpoint: ""

# Service-Specific Configuration (added for each service)
# FileProcessor
fileprocessor:
  config:
    concurrentFiles: "10"
    maxFileSizeMB: "1000"

# Frontend
frontend:
  config:
    apiBaseUrl: "http://datasource-management:5001"

# Health Probes (apply to all services)
defaultProbes:
  livenessProbe:
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  readinessProbe:
    initialDelaySeconds: 20
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 2

# Rolling Update Strategy (defaults)
defaultStrategy:
  maxSurge: 1
  maxUnavailable: 0
